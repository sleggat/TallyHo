function edit_task(){event.preventDefault();var e=$(this).parents(".task_container"),t=e.attr("data-path"),a=e.attr("data-datetime"),i=e.attr("data-duration"),s=e.attr("data-expense");task_handler("edit",e.attr("data-client"),e.attr("data-project"),e.attr("data-description"),a,i,s,t)}function duplicate_task(){event.preventDefault();var e=$(this).parents(".task_container"),t=e.attr("data-duration"),a=e.attr("data-expense");task_handler("duplicate",e.attr("data-client"),e.attr("data-project"),e.attr("data-description"),null,t,a,null)}function delete_task(){event.preventDefault();var e=$(this).parents(".task_container").attr("data-path");$("#modal_delete .modal-card-title").html('<span class="icon is-size-6"><i class="fas fa-trash"></i></span> Delete Task'),$("#modal_delete .modal_path").val(e),$("#modal_delete .modal_delete_path").html(e),$("#modal_delete").addClass("is-active")}function task_handler(e,t,a,i,s,l,d,n){event.preventDefault(),$(".dropdown").removeClass("is-active");var o="client";l=parseFloat(l)?l:15;switch(e){case"continue":var r='<span class="icon is-size-6"><i class="far fa-clone"></i></span> Continue Task';s=get_current_datetime(),o="description";break;case"duplicate":r='<span class="icon is-size-6"><i class="fas fa-copy"></i></span> Duplicate Task',s=get_current_datetime(),o="description";break;case"add":r='<span class="icon is-size-6"><i class="fas fa-plus"></i></span> Add New Task',s=get_current_datetime(),o="client";break;case"edit":r='<span class="icon is-size-6"><i class="fas fa-edit"></i></span> Edit Task',o="description"}$("#modal_update .modal-card-title").html(r),$("#modal_update .modal_datetime").val(s),$("#modal_update .modal_duration").val(l),$("#modal_update .modal_expense").val(d),$("#modal_update .modal_client").val(t),$("#modal_update .modal_project").val(a),$("#modal_update .modal_description").val(i),$("#modal_update .modal_path").val(n),$("#modal_update .modal_"+o).attr("autofocus","autofocus").focus(),$("#modal_update").addClass("is-active"),$("html").addClass("is-clipped"),d>0?$(".set_expense").trigger("click"):$(".set_duration").trigger("click"),initpicker("#modal_update")}function get_current_datetime(){var e=new Date;return e.getFullYear()+("0"+(e.getMonth()+1)).slice(-2)+("0"+e.getDate()).slice(-2)+("00"+e.getHours()).slice(-2)+("00"+e.getMinutes()).slice(-2)}function initpicker(e){$(e+" .modal_datetime").daterangepicker({singleDatePicker:!0,timePicker:!0,timePickerIncrement:1,locale:{format:"YYYY-MM-DD hh:mm A",applyLabel:"Apply",cancelLabel:"Cancel",daysOfWeek:["Su","Mo","Tu","We","Th","Fr","Sa"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"]},autoUpdateInput:!0})}function timeConvert(e){var t=e/60,a=Math.floor(t),i=60*(t-a);return a+"h "+Math.round(i)+"m"}function recalculate_costs(){var e=0,t=0,a=0;$(".highlighted").each((function(i){var s=$(this).children().find(".task_value").attr("data-costraw"),l=$(this).children().find(".task_duration").text();e+=parseFloat(s),t+=parseFloat(l),a=i+1})),e=e.toFixed(2),$("#total_selected").text(a),$("#total_mins").text(timeConvert(t)),$("#total_cost").text(e),0==e?$("#tally").fadeOut("fast"):$("#tally").fadeIn("fast")}$(document).ready((function(){$(document).keyup((function(e){27===e.keyCode&&($(".modal").removeClass("is-active"),$("html").removeClass("is-clipped"))})),$(".delete, .modal-background").click((function(){$(".modal").removeClass("is-active"),$("html").removeClass("is-clipped")})),initpicker("#form_add")})),$(".modal_edit").bind("click",edit_task),$(".table_col").bind("dblclick",edit_task),$(".modal_duplicate").bind("click",duplicate_task),$(".modal_delete").bind("click",delete_task),$(".dropdown button").click((function(e){e.preventDefault();var t=$(this).parents(".dropdown"),a=$(this).parents(".dropdown-container").width();$(this).parents(".dropdown-container").find(".dropdown-content").width(a),$(".dropdown").not(t).removeClass("is-active"),t.toggleClass("is-active")})),$(".dropdown-selection").click((function(e){e.preventDefault();var t=$(this).attr("data-value"),a=$(this).parents(".dropdown-container").find(".input");$(a).val(t),$(".dropdown").removeClass("is-active")})),$(".set_duration").click((function(e){e.preventDefault(),$(".set_duration").removeClass("is-link"),$(".set_duration").addClass("is-white"),$(".set_expense").removeClass("is-white"),$(".set_expense").addClass("is-link"),$(".modal_tasktype").val("duration"),$(".field_duration").is(":hidden")&&($(".field_expense").hide(),$(".field_duration").show())})),$(".set_expense").click((function(e){e.preventDefault(),$(".set_expense").removeClass("is-link"),$(".set_expense").addClass("is-white"),$(".set_duration").removeClass("is-white"),$(".set_duration").addClass("is-link"),$(".modal_tasktype").val("expense"),$(".field_expense").is(":hidden")&&($(".field_duration").hide(),$(".field_expense").show())})),$(".day_header").click((function(e){e.preventDefault();var t=$(this).attr("data-date");$("."+t+" > .task_container").toggleClass("highlighted"),recalculate_costs()})),$(".table_col:not(.task_col_4)").click((function(e){e.preventDefault(),$(this).parents(".task_container").toggleClass("highlighted"),recalculate_costs()})),$("#tally").click((function(e){e.preventDefault(),$(".task_container").removeClass("highlighted"),recalculate_costs()}));