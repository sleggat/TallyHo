# rewrite rules
<IfModule mod_rewrite.c>

RewriteEngine on

# block files and folders beginning with a dot, such as .git
# except for the .well-known folder, which is used for Let's Encrypt and security.txt
RewriteRule (^|/)\.(?!well-known\/) index.php [L]

# block all files in the content folder from being accessed directly
RewriteRule ^data/(.*) index.php [L]
RewriteRule ^backups/(.*) index.php [L]
RewriteRule ^cache/(.*) index.php [L]

# block all files in the site folder from being accessed directly, except js and css folders
RewriteRule ^guts/(js|css|forms)/ - [L]
RewriteRule ^guts/(.*) index.php [F]

# make site links work
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*) index.php [L]

</IfModule>

# compress text file responses
<IfModule mod_deflate.c>
AddOutputFilterByType DEFLATE text/plain
AddOutputFilterByType DEFLATE text/html
AddOutputFilterByType DEFLATE text/css
AddOutputFilterByType DEFLATE text/javascript
AddOutputFilterByType DEFLATE application/json
AddOutputFilterByType DEFLATE application/javascript
AddOutputFilterByType DEFLATE application/x-javascript
</IfModule>
